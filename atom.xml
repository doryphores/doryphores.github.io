<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title><![CDATA[1 Pixel Out]]></title>
  
  <link href="/atom.xml" rel="self"/>
  <link href="http://1pixelout.net/"/>
  <updated>2015-09-18T14:13:36.000Z</updated>
  <id>http://1pixelout.net/</id>
  
  <author>
    <name><![CDATA[Martin Laine]]></name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title><![CDATA[Writing hexo template helpers]]></title>
    <link href="http://1pixelout.net/2015/09/18/writing-hexo-template-helpers/"/>
    <id>http://1pixelout.net/2015/09/18/writing-hexo-template-helpers/</id>
    <published>2015-09-18T13:31:32.000Z</published>
    <updated>2015-09-18T14:13:36.000Z</updated>
    <content type="html"><![CDATA[<p>Instead of including JavaScript in your hexo layout templates, it’s better to move it to a collection of helpers that you can define in your theme’s scripts.</p>
<p>A good example is the logic for setting the page title included in hexo’s default <strong>landscape</strong> theme.</p>
<p>The following code is present at the top of the theme’s <code>head.ejs</code> partial:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> title = page.title;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (is_archive())&#123;</span><br><span class="line">  title = <span class="string">'Archives'</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (is_month())&#123;</span><br><span class="line">    title += <span class="string">': '</span> + page.year + <span class="string">'/'</span> + page.month;</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (is_year())&#123;</span><br><span class="line">    title += <span class="string">': '</span> + page.year;</span><br><span class="line">  &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (is_category())&#123;</span><br><span class="line">  title = <span class="string">'Category: '</span> + page.category;</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (is_tag())&#123;</span><br><span class="line">  title = <span class="string">'Tag: '</span> + page.tag;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>It feels wrong to me to include this in a template. A better solution is to register a <code>page_title</code> helper for the theme. For this, create a new file in the theme’s <code>scripts</code> folder (the docs only mention the site top-level <code>scripts</code> folder but you can also place scripts in the theme’s folder).</p>
<p>Here’s how you register a new helper called <code>page_title</code>:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">hexo.extend.helper.register(<span class="string">"page_title"</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> title = <span class="keyword">this</span>.page.title;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">this</span>.is_archive()) &#123;</span><br><span class="line">    title = <span class="string">"Archives"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.is_month()) &#123;</span><br><span class="line">    title += <span class="string">': '</span> + <span class="keyword">this</span>.page.year + <span class="string">'/'</span> + <span class="keyword">this</span>.page.month;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">this</span>.is_year()) &#123;</span><br><span class="line">      title += <span class="string">": "</span> + <span class="keyword">this</span>.page.year;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">this</span>.is_category()) &#123;</span><br><span class="line">    title = <span class="string">"Category: "</span> + <span class="keyword">this</span>.page.category;</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">this</span>.is_tag()) &#123;</span><br><span class="line">    title = <span class="string">"Tag: "</span> + <span class="keyword">this</span>.page.tag;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> title;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>As you can see, the <code>page</code> object as well as all the other standard hexo objects such as <code>config</code> and <code>site</code> are available through the <code>this</code> scope of the helper.</p>
]]></content>
    <summary type="html">
    <![CDATA[<p>Instead of including JavaScript in your hexo layout templates, it’s better to move it to a collection of helpers that you can define in y]]>
    </summary>
    
      <category term="hexo" scheme="http://1pixelout.net/tags/hexo/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Setting and reading cookies when using Rack::Test]]></title>
    <link href="http://1pixelout.net/2015/09/16/setting-and-reading-cookies-when-using-rack-test/"/>
    <id>http://1pixelout.net/2015/09/16/setting-and-reading-cookies-when-using-rack-test/</id>
    <published>2015-09-16T10:25:10.000Z</published>
    <updated>2015-09-18T20:31:13.000Z</updated>
    <content type="html"><![CDATA[<p>I used the following for testing a <a href="www.sinatrarb.com/">sinatra</a> app using <a href="http://rspec.info/" target="_blank" rel="external">rspec</a> and <a href="https://github.com/jnicklas/turnip" target="_blank" rel="external">turnip</a>. I needed to write a feature to test that a particular request was setting a cookie with an expiry date and that it would behave correctly when a cookie was already present in the browser.</p>
<h2 id="To_set_a_cookie_with_an_expiry_date">To set a cookie with an expiry date</h2><p>For example, to set the expiry date 30 days in the future:</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set_cookie <span class="string">"name=value; expires=<span class="subst">#&#123;<span class="constant">Time</span>.now + <span class="number">30</span>.days&#125;</span>"</span></span><br></pre></td></tr></table></figure>
<h2 id="To_check_expiry_date_of_a_cookie_set_by_the_response">To check expiry date of a cookie set by the response</h2><p>Cookies are set by the response’s <code>Set-Cookie</code> header. To check the <code>expires</code> option, we need to parse the header and create <code>Cookie</code> objects:</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">cookies_from_response</span><span class="params">(response=last_response)</span></span></span><br><span class="line">  <span class="constant">Hash</span>[response[<span class="string">"Set-Cookie"</span>].lines.map &#123; |line|</span><br><span class="line">    cookie = <span class="constant">Rack::Test::Cookie</span>.new(line.chomp)</span><br><span class="line">    [cookie.name, cookie]</span><br><span class="line">  &#125;]</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>So now we can do something like:</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cookie = cookies_from_response[<span class="string">"cookie_name"</span>]</span><br><span class="line">expect(cookie.expires).to be_within(<span class="number">5</span>.minutes).of(<span class="number">30</span>.days.from_now)</span><br></pre></td></tr></table></figure>
<p>The <code>be_within</code> matcher is perfect here because we cannot check the exact expiry date.</p>
]]></content>
    <summary type="html">
    <![CDATA[<p>I used the following for testing a <a href="www.sinatrarb.com/">sinatra</a> app using <a href="http://rspec.info/" target="_blank" rel="e]]>
    </summary>
    
      <category term="ruby" scheme="http://1pixelout.net/tags/ruby/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Git WIP aliases]]></title>
    <link href="http://1pixelout.net/2015/09/15/git-wip-aliases/"/>
    <id>http://1pixelout.net/2015/09/15/git-wip-aliases/</id>
    <published>2015-09-15T12:39:56.000Z</published>
    <updated>2015-09-18T20:24:34.000Z</updated>
    <content type="html"><![CDATA[<p>Just so I can stop looking up how to set these, here are my git command aliases:</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">[alias]</span></span><br><span class="line"><span class="setting">co = <span class="value">checkout</span></span></span><br><span class="line"><span class="setting">br = <span class="value">branch</span></span></span><br><span class="line"><span class="setting">ci = <span class="value">commit</span></span></span><br><span class="line"><span class="setting">st = <span class="value">status</span></span></span><br><span class="line"><span class="setting">unstage = <span class="value">reset HEAD --</span></span></span><br><span class="line"><span class="setting">fp = <span class="value"><span class="string">"!git fetch -p; git pull"</span></span></span></span><br><span class="line"><span class="setting">wip = <span class="value"><span class="string">"!git add --all; git ci -m WIP"</span></span></span></span><br><span class="line"><span class="setting">unwip = <span class="value"><span class="string">"!git reset --soft HEAD~1; git unstage"</span></span></span></span><br></pre></td></tr></table></figure>
<p><code>git wip</code> stages all current changes and commits them. Not sure why I prefer it to <code>git stash</code>.</p>
<p><code>git unwip</code> obviously undoes a <code>git wip</code>.</p>
]]></content>
    <summary type="html">
    <![CDATA[<p>Just so I can stop looking up how to set these, here are my git command aliases:</p>
<figure class="highlight ini"><table><tr><td class="]]>
    </summary>
    
      <category term="git" scheme="http://1pixelout.net/tags/git/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Prevent copying empty selections in Atom]]></title>
    <link href="http://1pixelout.net/2015/09/14/prevent-copying-empty-selection-in-atom/"/>
    <id>http://1pixelout.net/2015/09/14/prevent-copying-empty-selection-in-atom/</id>
    <published>2015-09-14T20:29:06.000Z</published>
    <updated>2015-09-18T20:32:36.000Z</updated>
    <content type="html"><![CDATA[<p>I really can’t do with an editor that clears my clipboard when I accidently copy an empty line.</p>
<p>This is an easy mistake to make:</p>
<ul>
<li>cut something with <code>Cmd+X</code></li>
<li>move the cursor to an empty line where I want to paste</li>
<li>accidently hit <code>Cmd+C</code> instead of <code>Cmd+V</code></li>
<li>Boom! I have now lost my clipboard contents</li>
</ul>
<p>Sublime Text had an option to disable copying empty selections but Atom doesn’t. Fortunately, it’s super easy to hack Atom and someone has figured out how to prevent this. I’m pasting it here so I can easily find it.</p>
<p>This is <a href="https://discuss.atom.io/t/resolved-avoid-copying-when-selection-is-empty/16397/4" target="_blank" rel="external">the original post</a> on the Atom forum and here’s the snippet to paste in your Atom init script.</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># prevent core:copy if and only if there's one selection in</span></span><br><span class="line"><span class="comment"># the active editor (mini or not) and its length equals 0</span></span><br><span class="line">atom.commands.add <span class="string">'atom-text-editor'</span>, <span class="string">'core:copy'</span>, <span class="function"><span class="params">(e)</span> -&gt;</span></span><br><span class="line">  editor = e.currentTarget.getModel()</span><br><span class="line"></span><br><span class="line">  <span class="comment"># do nothing if there's more than 1 selection</span></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">if</span> editor.getSelectedBufferRanges().length &gt; <span class="number">1</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># get the starting and ending points of the selection</span></span><br><span class="line">  &#123;start, end&#125; = editor.getSelectedBufferRange()</span><br><span class="line"></span><br><span class="line">  <span class="comment"># stop the command from immediate propagation (i.e.</span></span><br><span class="line">  <span class="comment"># executing the same command on the same element or</span></span><br><span class="line">  <span class="comment"># an element higher up the DOM tree). This works</span></span><br><span class="line">  <span class="comment"># because atom executes commands in the reverse order</span></span><br><span class="line">  <span class="comment"># they were registered with atom.commands.add, and this</span></span><br><span class="line">  <span class="comment"># one's added after the core commands are already</span></span><br><span class="line">  <span class="comment"># registered.</span></span><br><span class="line">  <span class="keyword">if</span> start.column <span class="keyword">is</span> end.column <span class="keyword">and</span> start.row <span class="keyword">is</span> end.row</span><br><span class="line">    e.stopImmediatePropagation()</span><br></pre></td></tr></table></figure>
]]></content>
    <summary type="html">
    <![CDATA[<p>I really can’t do with an editor that clears my clipboard when I accidently copy an empty line.</p>
<p>This is an easy mistake to make:</]]>
    </summary>
    
      <category term="atom" scheme="http://1pixelout.net/tags/atom/"/>
    
  </entry>
  
</feed>
